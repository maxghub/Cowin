(function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;jQuery(function(){var CompareView,HR,ref;return CompareView=function(superClass){function CompareView(){return CompareView.__super__.constructor.apply(this,arguments)}return extend(CompareView,superClass),CompareView.prototype.template="compare",CompareView.prototype.table_template="compare-result",CompareView.prototype.className="compare-view container mjB",CompareView.prototype.events={"click button.compare":"compare","click .challenge-url":"challengeTrackClick"},CompareView.prototype.initialize=function(options){var that;return that=this,this.contest_slug=options.contest_slug,this.hacker_slug_1=options.hacker_slug_1,this.hacker_slug_2=options.hacker_slug_2,this.model=new HR.CompareModel(options),this.model.fetchWithParams({success:function(){return that.render()}}),this.listenTo(this.model,"change",this.renderResult),this},CompareView.prototype.render=function(){return this.model.sync_status?(this.setBreadcrumb(),$(this.el).html(HR.appController.template(this.template,this)({model:this.model.toJSON()})),this.renderResult(),this.setupFindUser(this.$("input#hacker-username-1")),this.setupFindUser(this.$("input#hacker-username-2")),this):this},CompareView.prototype.renderResult=function(){var replace,result;return this.model.sync_status?(replace=!1,this.hacker_slug_1||this.hacker_slug_2||(replace=!0),HR.router.navigate(this.model.pageURL(),{trigger:!1,replace:replace}),this.$("#hacker-username-1").val(this.model.get("hacker_slug_1")),this.$("#hacker-username-2").val(this.model.get("hacker_slug_2")),result=HR.appController.template(this.table_template,this)({model:this.model.toJSON(),comparePreformance:this.comparePreformance}),this.$(".compare-result-table").html(result),this.hacker_slug_1=this.model.get("hacker_slug_1"),this.hacker_slug_2=this.model.get("hacker_slug_2")):this},CompareView.prototype.challengeTrackClick=function(e){var $element,difficulty,name,point,track_data;return point=($element=$(e.currentTarget)).data("point"),difficulty=$element.data("difficulty"),name=$element.data("name"),track_data={contest_slug:this.contest_slug,challengeName:name,challengePoints:point,challengeDifficulty:difficulty},hr_metrics.externalService("track","ClickOnComparisonChallenge",track_data)},CompareView.prototype.compare=function(){var current_hacker,hacker_slug_1,hacker_slug_2,self_flag,that,track_data;return this.$(".compare-result-table").html(new HR.LoadingView),that=this,this.model.set("hacker_slug_1",$("#hacker-username-1").val()),this.model.set("hacker_slug_2",$("#hacker-username-2").val()),this.model.fetchWithParams({success:function(){return that.renderResult()}}),current_hacker="",HR.profile()&&HR.profile().get("username")&&(current_hacker=HR.profile().get("username")),self_flag=!1,(hacker_slug_1=this.model.get("hacker_slug_1"))&&current_hacker===hacker_slug_1&&(self_flag=!0),(hacker_slug_2=this.model.get("hacker_slug_2"))&&current_hacker===hacker_slug_2&&(self_flag=!0),track_data={source:"Comparison Page Button",contest_slug:this.contest_slug,self:self_flag},hr_metrics.externalService("track","CompareProgress",track_data)},CompareView.prototype.comparePreformance=function(show1,show2,challenge,reverse,time){var attempted1,attempted2,ref,ref1,ref2,score1,score2,time1,time2;return attempted1=challenge.attempted1,attempted2=challenge.attempted2,score1=challenge.score1,score2=challenge.score2,time1=challenge.time1,time2=challenge.time2,reverse&&(attempted1=(ref=[attempted2,attempted1])[0],attempted2=ref[1],score1=(ref1=[score2,score1])[0],score2=ref1[1],time1=(ref2=[time2,time1])[0],time2=ref2[1]),!!(show1&&show2&&attempted1)&&(!(!attempted1||attempted2)||(score1!==score2?score1>score2:time?time1<time2:score1>score2))},CompareView.prototype.setBreadcrumb=function(){if(HR.appView.setBreadcrumb("global","All Contests","/contests"),this,this.contest_slug)return HR.appView.setBreadcrumb("contest",this.model.get("contest").name,"/contests/"+this.contest_slug)},CompareView.prototype.setupFindUser=function(el){if(!(el.length<1))return this,el.autocomplete({minLength:2,appendTo:"#autocomplete-"+el.selector.slice(-1),source:function(request,response){return $.ajax({url:"/rest/hackers/autocomplete?limit=4",data:{q:request.term},success:function(data){return response(data)}})},select:function(event,ui){return el.val(ui.item.value)}}).data("ui-autocomplete")._renderItem=function(ul,item){return $("<li></li>").data("ui-autocomplete-item",item).append($("<a></a>").append($("<div class='hacker-container'> <div class='hacker-avatar'> <img height='25' width='25' class='pull-left avatar profile_avatar' onerror=\"this.src='https://d1ce3iv5vajdy.cloudfront.net/hackerrank/assets/gravatar.jpg';\" src='/rest/hackers/"+$.trim(item.value)+"/avatar'> </div> <div class='hacker-details'> <p class='hacker-username'>"+item.value+"</p> </div> </div>"))).appendTo(ul)}},CompareView}(window.HR.GenericView),(HR=null!=(ref=window.HR)?ref:{}).CompareView=CompareView})}).call(this);